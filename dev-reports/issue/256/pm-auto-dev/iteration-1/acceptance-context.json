{
  "issue_number": 256,
  "feature_summary": "選択メッセージ（multiple_choice プロンプト）の検出精度向上",
  "acceptance_criteria": [
    "パターンA: 複数行に折り返された質問文（末尾が「。」）でもmultiple_choiceプロンプトが検出される",
    "行内（末尾以外の位置）に ? / ？ を含む折り返し行が質問行として検出される",
    "1行に収まる質問文（末尾が？）での検出が引き続き正常に動作する（回帰テスト）",
    "パターンB: model選択等の質問形式でないプロンプトもmultiple_choiceとして検出される",
    "requireDefaultIndicator: false（Claude CLI）パスでのmodel選択プロンプト検出をテスト",
    "requireDefaultIndicator: true（Codex/Gemini）パスでの既存動作が維持される（回帰テスト）",
    "SEC-001の誤検出防止ガードが維持される（通常の番号付きリストが誤検出されない）",
    "既存テスト T11h-T11m の False Positive防止ケースがすべてパスする",
    "Pattern 2（行内?チェック）で URLパラメータ行が誤検出されないことを確認",
    "Auto-Yes機能有効時に誤検出による自動応答の誤送信が発生しないことを確認",
    "インデントされた質問行（Select model 等）が isContinuationLine() でcontinuation lineとして誤分類されないことをテスト",
    "上方走査の範囲内にたまたまキーワードを含む行がある場合のFalse Positive防止テスト",
    "isContinuationLine()で走査を進めた後のquestionEndIndexを起点とした上方走査が正しく動作するテスト",
    "questionEndIndexの上方走査がscanStart境界を超える場合のガード処理テスト",
    "既存のprompt-detectorテストがすべてパスする"
  ],
  "test_scenarios": [
    "シナリオ1: 複数行折り返し質問の検出 - Claude CLIでAskUserQuestion形式のプロンプトが発行され、質問文が複数行に折り返される場合に、プロンプトパネルに正しく表示されること",
    "シナリオ2: model選択プロンプトの検出 - Claude CLIで /model コマンドを実行し、model選択プロンプトが表示される場合に、プロンプトパネルに正しく表示されること",
    "シナリオ3: False Positive防止の維持 - 通常の番号付きリスト（Steps:, Recommendations: 等）がプロンプトとして誤検出されず、プロンプトパネルが表示されないこと",
    "シナリオ4: Auto-Yes安全性の維持 - Auto-Yes機能が有効な場合でも、False Positiveによる誤った自動応答が送信されないこと"
  ],
  "tdd_result_path": "dev-reports/issue/256/pm-auto-dev/iteration-1/tdd-result.json"
}
