{"body":"## 概要\n\nセットアップ手順を簡素化し、必要な依存アプリの事前チェック機能を追加する。\n\n## 現状の課題\n\n### セットアップが複雑\n現在のセットアップフローは以下の通り多くの手順が必要：\n```bash\ngit clone → npm install → cp .env.example .env → 手動で.env編集 → npm run db:init → npm run build → npm start\n```\n\n### 事前チェックが不十分\n- Node.jsバージョンチェックのみ（`setup.sh`内）\n- tmux, git, Claude CLIなどの必須依存がチェックされていない\n\n### 環境変数設定が手動\n- `.env.example`をコピーして手動編集が必要\n- 必須項目（`CM_ROOT_DIR`など）の設定漏れが起きやすい\n\n## 目標のフロー\n\n```bash\nnpm install\n./scripts/preflight-check.sh   # 依存チェック（オプション：setup.shに統合可）\n./scripts/setup-env.sh         # 対話式.env設定\n./scripts/build-and-start.sh --daemon  # ビルド＆起動\n```\n\n## 実装内容\n\n### 1. `scripts/preflight-check.sh` - 事前チェックスクリプト\n\n依存アプリのインストール状況を確認：\n\n| 項目 | チェック内容 | 必須/任意 |\n|------|-------------|----------|\n| Node.js | バージョン20以上 | 必須 |\n| npm | インストール済み | 必須 |\n| tmux | インストール済み | 必須 |\n| git | インストール済み | 必須 |\n| Claude CLI | インストール済み | 任意（警告のみ） |\n\n出力例：\n```\n🔍 CommandMate 事前チェック\n\n✅ Node.js: v20.10.0\n✅ npm: 10.2.3\n✅ tmux: 3.4\n✅ git: 2.43.0\n⚠️ Claude CLI: 未インストール（オプション）\n\nすべての必須依存が満たされています。\n```\n\n### 2. `scripts/setup-env.sh` - 対話式環境変数設定\n\n対話形式で`.env`ファイルを生成：\n\n```\n🔧 CommandMate 環境設定\n\nリポジトリのルートディレクトリを入力してください\nCM_ROOT_DIR [/home/user/repos]: /path/to/repos\n\nポート番号を入力してください\nCM_PORT [3000]: \n\n外部アクセスを許可しますか？ (y/N): y\n→ CM_BIND=0.0.0.0\n→ 認証トークンを自動生成します: ****\n\n✅ .env ファイルを作成しました\n```\n\n### 3. `scripts/setup.sh` の拡張\n\n既存の`setup.sh`を拡張し、上記スクリプトを統合：\n\n```bash\n#!/bin/bash\n# 1. 事前チェック\n./scripts/preflight-check.sh || exit 1\n\n# 2. 依存インストール\nnpm install\n\n# 3. 環境変数設定（.envが存在しない場合）\nif [ ! -f .env ]; then\n  ./scripts/setup-env.sh\nfi\n\n# 4. DB初期化\nnpm run db:init\n\n# 5. ビルド\nnpm run build\n\necho \"セットアップ完了！\"\necho \"起動: ./scripts/build-and-start.sh --daemon\"\n```\n\n### 4. ドキュメント更新\n\n- `README.md` - クイックスタートセクションを簡素化\n- `docs/DEPLOYMENT.md` - 新スクリプトの使用方法を追記\n\n## 受け入れ条件\n\n- [ ] `preflight-check.sh` が全必須依存をチェックする\n- [ ] `setup-env.sh` が対話式で`.env`を生成する\n- [ ] `setup.sh` が統合フローを実行する\n- [ ] README.mdが更新されている\n- [ ] 各スクリプトにヘルプオプション（`-h`/`--help`）がある\n\n## 関連\n\n- 既存スクリプト: `scripts/setup.sh`, `scripts/build-and-start.sh`\n- 環境変数: Issue #76（フォールバック機能）","title":"セットアップ手順の簡素化と事前チェック機能の追加"}
