{
  "issue_number": 49,
  "issue_title": "マークダウンエディタとビューワーを追加",
  "branch": "develop",
  "design_doc_path": "dev-reports/design/issue-49-markdown-editor-design-policy.md",
  "work_plan_path": "dev-reports/issue/49/work-plan.md",
  "iteration": 1,
  "current_phase": "Phase 1 - 基盤構築",
  "acceptance_criteria": [
    "Filesタブでディレクトリの追加・リネーム・削除ができる",
    "空でないディレクトリ削除時に再帰削除の警告確認ダイアログが表示される",
    "Filesタブでmdファイルの追加・削除ができる",
    "mdファイル選択時にエディタが表示される",
    "エディタでmdファイルを編集・保存できる（手動保存: Ctrl/Cmd+S or 保存ボタン）",
    "保存成功時にトースト通知が表示される（3秒で自動消去）",
    "分割表示でマークダウンプレビューが確認できる（react-markdown使用）",
    "表示モード（分割/エディタのみ/プレビューのみ）を切り替えできる",
    "表示モードの選択がローカルストレージに保存され、次回アクセス時に復元される",
    "worktree外へのアクセスが禁止されている",
    "md以外のファイルは表示のみ（編集不可）",
    "エラー発生時に適切なエラーメッセージが表示される",
    "未保存状態でエディタを閉じる際に確認ダイアログが表示される",
    "大きなファイル（500KB超）編集時に警告が表示される"
  ],
  "tasks": [
    {
      "id": "1.1",
      "name": "パス検証互換性テスト作成",
      "output": "tests/integration/path-validation-compatibility.test.ts",
      "dependencies": [],
      "priority": "MF-001",
      "description": "URLエンコードされたパスの挙動確認テスト"
    },
    {
      "id": "1.2",
      "name": "ユーティリティ関数作成",
      "output": "src/lib/utils.ts",
      "dependencies": [],
      "description": "debounce関数"
    },
    {
      "id": "1.3",
      "name": "編集可能拡張子設定",
      "output": "src/config/editable-extensions.ts",
      "dependencies": [],
      "priority": "SF-003",
      "description": "編集可能な拡張子設定とvalidateContent"
    },
    {
      "id": "1.4",
      "name": "再帰削除安全設定",
      "output": "src/config/file-operations.ts",
      "dependencies": [],
      "priority": "SEC-SF-004",
      "description": ".git保護、削除上限設定"
    },
    {
      "id": "1.5",
      "name": "ファイル操作ビジネスロジック",
      "output": "src/lib/file-operations.ts",
      "dependencies": ["1.3", "1.4"],
      "priority": "SF-001",
      "description": "readFile, updateFile, createFileOrDirectory, deleteFileOrDirectory, renameFileOrDirectory"
    },
    {
      "id": "1.6",
      "name": "API拡張（PUT/POST/DELETE/PATCH）",
      "output": "src/app/api/worktrees/[id]/files/[...path]/route.ts",
      "dependencies": ["1.1", "1.5"],
      "description": "既存GETに加えてPUT/POST/DELETE/PATCH追加"
    },
    {
      "id": "1.7",
      "name": "APIテスト作成",
      "output": "tests/integration/api-file-operations.test.ts",
      "dependencies": ["1.6"],
      "description": "PUT/POST/DELETE/PATCHメソッドのテスト"
    },
    {
      "id": "1.8",
      "name": "セキュリティテスト作成",
      "output": "tests/integration/security.test.ts",
      "dependencies": ["1.6"],
      "description": "パストラバーサル、XSS対策テスト"
    }
  ],
  "test_commands": {
    "unit": "npm run test:unit",
    "integration": "npm run test:integration",
    "lint": "npm run lint",
    "typecheck": "npx tsc --noEmit"
  },
  "security_checklist": {
    "xss": "rehype-sanitize使用、dangerouslySetInnerHTML不使用",
    "path_traversal": "isPathSafe()一貫使用、newName検証",
    "recursive_delete": ".git保護、MAX_RECURSIVE_DELETE_FILES: 100",
    "error_response": "絶対パス含めない、スタックトレース抑制"
  }
}
