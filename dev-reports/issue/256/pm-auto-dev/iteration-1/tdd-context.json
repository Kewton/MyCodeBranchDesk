{
  "issue_number": 256,
  "title": "選択メッセージが表示されない",
  "acceptance_criteria": [
    "パターンA: 複数行に折り返された質問文（末尾が「。」）でもmultiple_choiceプロンプトが検出される",
    "行内（末尾以外の位置）に ? / ？ を含む折り返し行が質問行として検出される",
    "1行に収まる質問文（末尾が？）での検出が引き続き正常に動作する（回帰テスト）",
    "パターンB: model選択等の質問形式でないプロンプトもmultiple_choiceとして検出される",
    "requireDefaultIndicator: false（Claude CLI）パスでのmodel選択プロンプト検出をテスト",
    "requireDefaultIndicator: true（Codex/Gemini）パスでの既存動作が維持される（回帰テスト）",
    "SEC-001の誤検出防止ガードが維持される（通常の番号付きリストが誤検出されない）",
    "既存テスト T11h-T11m の False Positive防止ケースがすべてパスする",
    "Pattern 2（行内?チェック）で URLパラメータ行が誤検出されないことを確認",
    "Auto-Yes機能有効時に誤検出による自動応答の誤送信が発生しないことを確認",
    "インデントされた質問行（Select model 等）が isContinuationLine() でcontinuation lineとして誤分類されないことをテスト",
    "上方走査の範囲内にたまたまキーワードを含む行がある場合のFalse Positive防止テスト",
    "isContinuationLine()で走査を進めた後のquestionEndIndexを起点とした上方走査が正しく動作するテスト",
    "questionEndIndexの上方走査がscanStart境界を超える場合のガード処理テスト",
    "既存のprompt-detectorテストがすべてパスする"
  ],
  "implementation_tasks": [
    "Task 1.1: isQuestionLikeLine() に Pattern 2（行内?チェック）を追加",
    "Task 1.2: QUESTION_SCAN_RANGE 定数を定義（値=3、JSDocに変更ガイドライン追記）",
    "Task 1.3: findQuestionLineInRange() 関数を実装（上方走査ロジック、scanRangeバリデーション）",
    "Task 1.4: Pass 2ループ内で isQuestionLikeLine() チェックを isContinuationLine() の手前に追加（MF-001対応）",
    "Task 1.5: SEC-001bガードで findQuestionLineInRange() を呼び出す上方走査を実装",
    "Task 2.1: パターンAテストケース追加（T-256-A1~A3）",
    "Task 2.2: パターンBテストケース追加（T-256-B1~B2）",
    "Task 2.3: False Positive防止テストケース追加（T-256-FP1~FP3）",
    "Task 2.4: isContinuationLine相互作用テストケース追加（T-256-CL1）",
    "Task 2.5: findQuestionLineInRange単体テスト追加（T-256-FQ1~FQ4）",
    "Task 2.6: 境界条件テストケース追加（T-256-BC1~BC3）",
    "Task 2.7: 既存テスト回帰確認（T11h-T11m, T11a-T11g, T1-T4, Issue #181, Issue #161）"
  ],
  "target_coverage": 80,
  "design_policy_path": "dev-reports/design/issue-256-multiple-choice-prompt-detection-design-policy.md",
  "work_plan_path": "dev-reports/issue/256/work-plan.md"
}
