{
  "issue_number": 190,
  "feature_summary": "トップ画面にて登録済みのリポジトリを削除してもsyncallで復活する - 修正",
  "acceptance_criteria": [
    "UIで削除したリポジトリがSync Allで復活しないこと",
    "環境変数に設定されたリポジトリでも除外が有効であること",
    "CM_ROOT_DIR設定時でも除外が有効であること",
    "複数リポジトリの一部削除→Sync Allで未削除リポジトリは正常同期されること",
    "除外したリポジトリを再度登録（復活）できること",
    "復活操作後、手動Sync All不要でworktreesテーブルが自動復元されること",
    "削除確認ダイアログに除外される旨と復活方法が明示されていること",
    "環境変数リポジトリがpath.resolve()で正規化された上でrepositoriesテーブルに登録されること",
    "復活APIのエラーハンドリングが適切に実装されていること（404, warning付き200, 500）",
    "既存テストがすべてパスすること"
  ],
  "test_scenarios": [
    "シナリオ1: DELETE /api/repositoriesでリポジトリを削除→repositories.enabled=0に更新されること",
    "シナリオ2: 削除後にPOST /api/repositories/syncを実行→削除したリポジトリが復活しないこと",
    "シナリオ3: GET /api/repositories/excludedで除外リポジトリ一覧が取得できること",
    "シナリオ4: PUT /api/repositories/restoreで除外リポジトリを復活→enabled=1に更新されworktreesも復元されること",
    "シナリオ5: 復活APIで存在しないリポジトリを指定→404レスポンス",
    "シナリオ6: 復活APIでディスク上に存在しないパスを指定→200+warning応答",
    "シナリオ7: パストラバーサル攻撃（null byte、システムディレクトリ）でDELETE/restoreが400エラー",
    "シナリオ8: MAX_DISABLED_REPOSITORIES上限超過→disableRepository()がエラー",
    "シナリオ9: resolveRepositoryPath()が相対パスを絶対パスに変換、末尾スラッシュを正規化",
    "シナリオ10: ensureEnvRepositoriesRegistered()の冪等性（二重登録なし）",
    "シナリオ11: filterExcludedPaths()がenabled=0のパスを除外、enabled=1のパスは残存",
    "シナリオ12: ESLint/TypeScript/ユニットテスト/ビルドが全パス"
  ]
}
