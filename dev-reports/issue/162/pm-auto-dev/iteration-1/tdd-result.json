{
  "status": "success",
  "issue_number": 162,
  "iteration": 1,
  "tdd_cycle": {
    "red": {
      "status": "completed",
      "test_files_created": [
        "tests/unit/lib/file-operations-validate.test.ts",
        "tests/unit/lib/file-operations-move.test.ts",
        "tests/unit/lib/date-utils.test.ts",
        "tests/unit/lib/file-tree-timestamps.test.ts"
      ],
      "total_new_tests": 43
    },
    "green": {
      "status": "completed",
      "implementation_files": [
        "src/lib/file-operations.ts",
        "src/lib/date-utils.ts",
        "src/lib/file-tree.ts",
        "src/types/models.ts",
        "src/app/api/worktrees/[id]/files/[...path]/route.ts",
        "src/components/worktree/MoveDialog.tsx",
        "src/components/worktree/ContextMenu.tsx",
        "src/components/worktree/FileViewer.tsx",
        "src/components/worktree/FileTreeView.tsx",
        "src/components/worktree/WorktreeDetailRefactored.tsx",
        "src/hooks/useFileOperations.ts",
        "locales/en/worktree.json",
        "locales/ja/worktree.json",
        "locales/en/error.json",
        "locales/ja/error.json"
      ]
    },
    "refactor": {
      "status": "completed",
      "notes": "Extracted updateTreeNode to module-level function in MoveDialog.tsx to resolve ESLint react-hooks/exhaustive-deps warning. Refactored renameFileOrDirectory to use shared validateFileOperation for DRY compliance."
    }
  },
  "test_results": {
    "total_tests": 3385,
    "passed": 3385,
    "failed": 0,
    "skipped": 7,
    "test_files_total": 173,
    "test_files_passed": 172,
    "test_files_failed": 0,
    "infrastructure_errors": 1,
    "infrastructure_error_note": "Pre-existing Vitest worker crash (not related to Issue #162 changes)"
  },
  "new_test_results": {
    "total": 43,
    "passed": 43,
    "failed": 0,
    "breakdown": {
      "file-operations-validate": 8,
      "file-operations-move": 22,
      "date-utils": 7,
      "file-tree-timestamps": 6
    }
  },
  "coverage": {
    "date-utils.ts": {
      "statements": 100,
      "branches": 100,
      "functions": 100,
      "lines": 100
    },
    "file-operations.ts": {
      "statements": 74.12,
      "branches": 74.83,
      "functions": 100,
      "lines": 74.12,
      "note": "Uncovered lines are in pre-existing code (renameFileOrDirectory error handling, writeBinaryFile error handling), not in new Issue #162 code"
    },
    "file-tree.ts": {
      "statements": 61.19,
      "branches": 43.75,
      "functions": 36.36,
      "lines": 63.07,
      "note": "Low coverage is for pre-existing untested functions, birthtime addition is covered"
    }
  },
  "static_analysis": {
    "typescript": {
      "status": "pass",
      "errors": 0
    },
    "eslint": {
      "status": "pass",
      "warnings": 0,
      "errors": 0
    }
  },
  "security_checks": {
    "SEC-005_protected_directory": "Implemented and tested (3 tests for source, 2 tests for destination)",
    "SEC-006_symlink_validation": "Implemented and tested (1 test with symlink pointing outside worktree)",
    "SEC-007_move_into_self": "Implemented and tested (3 tests: self, deeply nested child, path-prefix false positive prevention)",
    "SEC-008_final_destination_validation": "Implemented and tested (1 test for destinationDir + basename validation)",
    "SEC-009_toctou_defense": "Implemented and tested (1 test for pre-existing destination file detection)"
  },
  "features_implemented": {
    "backend": {
      "validateFileOperation": "Shared validation function for file operations (DRY, MF-001)",
      "moveFileOrDirectory": "File/directory move with 5 security layers (SEC-005 through SEC-009)",
      "api_route_move": "PATCH handler with action:'move' support",
      "birthtime": "TreeItem.birthtime field and readDirectory() birthtime retrieval",
      "formatRelativeTime": "date-fns based relative time formatting with locale support"
    },
    "frontend": {
      "MoveDialog": "Directory tree browser dialog for destination selection",
      "useFileOperations": "Custom hook for move state management (SRP)",
      "ContextMenu_move": "Move menu item in file context menu",
      "FileViewer_copy": "Copy button with icon feedback (Copy -> Check, 2s)",
      "FileTreeView_birthtime": "Birthtime display in file tree with locale formatting"
    },
    "i18n": {
      "en_worktree": "fileTree section (moveTo, moveDialogTitle, moveConfirm, moveSuccess, timeAgo, rootDirectory)",
      "ja_worktree": "fileTree section (Japanese translations)",
      "en_error": "failedToMove added",
      "ja_error": "failedToMove added (Japanese)"
    }
  },
  "files_changed": {
    "new": [
      "src/lib/date-utils.ts",
      "src/hooks/useFileOperations.ts",
      "src/components/worktree/MoveDialog.tsx",
      "tests/unit/lib/file-operations-validate.test.ts",
      "tests/unit/lib/file-operations-move.test.ts",
      "tests/unit/lib/date-utils.test.ts",
      "tests/unit/lib/file-tree-timestamps.test.ts"
    ],
    "modified": [
      "src/lib/file-operations.ts",
      "src/lib/file-tree.ts",
      "src/types/models.ts",
      "src/app/api/worktrees/[id]/files/[...path]/route.ts",
      "src/components/worktree/ContextMenu.tsx",
      "src/components/worktree/FileViewer.tsx",
      "src/components/worktree/FileTreeView.tsx",
      "src/components/worktree/WorktreeDetailRefactored.tsx",
      "locales/en/worktree.json",
      "locales/ja/worktree.json",
      "locales/en/error.json",
      "locales/ja/error.json"
    ]
  }
}
