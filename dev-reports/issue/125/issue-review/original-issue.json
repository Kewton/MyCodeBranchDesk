{"body":"## Bug Description\n\nWhen CommandMate is installed globally (`npm install -g commandmate`), the `init` command saves `.env` to `~/.commandmate/.env`, but the `start` command looks for `.env` in `process.cwd()` (current working directory).\n\nThis causes the server to not load the configuration, resulting in \"Invalid or unsafe repository path\" errors when trying to register repositories.\n\n## Steps to Reproduce\n\n1. Install globally: `npm install -g commandmate`\n2. Run init: `commandmate init` (saves to `~/.commandmate/.env`)\n3. Run start: `commandmate start --daemon`\n4. Try to register a repository → Error: \"Invalid or unsafe repository path\"\n\n## Root Cause\n\n`src/cli/commands/start.ts:25`:\n```typescript\nconst envPath = join(process.cwd(), '.env');  // ❌ Always looks in cwd\n```\n\n`src/cli/commands/init.ts` uses:\n```typescript\nconst envPath = getEnvPath();  // ✅ Uses ~/.commandmate/.env for global install\n```\n\n## Expected Behavior\n\n`start.ts` should use `getEnvPath()` to find the `.env` file location, consistent with `init.ts`.\n\n## Proposed Fix\n\n1. Update `start.ts` to use `getEnvPath()` from `env-setup.ts`\n2. Update `daemon.ts` to pass the correct `.env` path to the spawned process\n3. Ensure Next.js loads the `.env` from the correct location\n\n## Workaround\n\nUsers can work around this by:\n```bash\n# Option 1: Create symlink\nln -s ~/.commandmate/.env ~/.env\n\n# Option 2: Copy .env to cwd\ncp ~/.commandmate/.env ./.env\n\n# Option 3: Run from home directory\ncd ~ && commandmate start\n```\n\n## Related\n\n- Issue #119: commandmate init interactive mode\n- Issue #96: npm install CLI support\n\n## Environment\n\n- commandmate version: 0.1.7\n- Node.js: v20+\n- OS: macOS","title":"fix(cli): start command does not load .env from ~/.commandmate for global install"}
