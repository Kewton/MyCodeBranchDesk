# 設計方針書: Claude Code標準スラッシュコマンド対応

## Issue情報
- **Issue番号**: #56
- **タイトル**: claude code標準搭載のスラッシュコマンドを利用出来るようにする
- **作成日**: 2026-01-25

---

## 1. 要件分析

### 要求事項
- Claude Code標準搭載のスラッシュコマンド（`/clear`, `/compact`等）を利用可能にする
- 最新のClaude Code機能をフル活用したい

### 制約条件
- Claude Codeの標準機能が追加された際、**自動で対応**してほしい

---

## 2. 調査結果

### 2.1 Claude Code標準スラッシュコマンド一覧（39種類）

| コマンド | 機能 | カテゴリ |
|---------|------|---------|
| `/add-dir` | セッションに追加の作業ディレクトリを追加 | セッション |
| `/agents` | カスタムAIサブエージェントを管理 | 拡張機能 |
| `/bashes` | バックグラウンドタスクの表示と管理 | ツール |
| `/bug` | Anthropicチームへバグを直接報告 | サポート |
| `/clear` | 会話履歴をクリアして新規開始 | セッション |
| `/compact` | 会話をオプションフォーカスで圧縮 | セッション |
| `/config` | 設定インターフェースを開く | 設定 |
| `/context` | コンテキスト使用量をカラーグリッドで表示 | モニタリング |
| `/cost` | トークン使用量と費用統計を表示 | モニタリング |
| `/doctor` | インストール問題をチェック | サポート |
| `/exit` | Claude Code REPLを終了 | セッション |
| `/export` | 会話をファイルやクリップボードにエクスポート | ユーティリティ |
| `/help` | 利用可能なスラッシュコマンド一覧 | ヘルプ |
| `/hooks` | フック設定を管理 | 設定 |
| `/ide` | IDE統合を管理し状態を表示 | 統合 |
| `/init` | CLAUDE.mdガイドファイルでプロジェクト初期化 | 初期化 |
| `/install-github-app` | GitHub Actions設定 | 統合 |
| `/login` | Anthropicアカウント間を切り替え | 認証 |
| `/logout` | 現在のアカウントからログアウト | 認証 |
| `/mcp` | MCPサーバー接続とOAuthを管理 | 拡張機能 |
| `/memory` | CLAUDE.mdメモリファイルを編集 | 設定 |
| `/model` | AIモデル(Opus、Sonnet、Haiku)を切り替え | 設定 |
| `/output-style` | 出力スタイルを直接またはメニューから設定 | 設定 |
| `/permissions` | ツールアクセス権限を表示・更新 | 設定 |
| `/plugin` | Claude Codeプラグインを管理 | 拡張機能 |
| `/pr-comments` | プルリクエストコメントを表示 | Git |
| `/privacy-settings` | プライバシー設定を表示・更新 | 設定 |
| `/release-notes` | リリースノートを表示 | ヘルプ |
| `/resume` | 前の会話を続行 | セッション |
| `/review` | 現在の変更内容をコードレビュー | Git |
| `/rewind` | 会話またはコードを前の状態にリセット | セッション |
| `/sandbox` | 隔離されたbash環境を有効化 | セキュリティ |
| `/security-review` | 保留中の変更内容をセキュリティレビュー | セキュリティ |
| `/status` | バージョン、モデル、アカウント情報を表示 | モニタリング |
| `/statusline` | Claude Codeステータスラインを設定 | 設定 |
| `/terminal-setup` | Shift+Enterキーバインディングをインストール | 設定 |
| `/todos` | 現在のTODOエントリを一覧表示 | タスク |
| `/usage` | プラン使用制限とレート制限を表示 | モニタリング |
| `/vim` | Vimモード(Insert/Command)を有効化 | 設定 |

### 2.2 現在のプロジェクト構成

```
.claude/
├── commands/           # カスタムスラッシュコマンド（12個）
│   ├── acceptance-test.md
│   ├── architecture-review.md
│   ├── bug-fix.md
│   ├── create-pr.md
│   ├── design-policy.md
│   ├── issue-create.md
│   ├── issue-split.md
│   ├── pm-auto-dev.md
│   ├── progress-report.md
│   ├── refactoring.md
│   ├── tdd-impl.md
│   └── work-plan.md
├── agents/             # サブエージェント定義（5個）
├── prompts/            # コアプロンプト（4個）
├── skills/             # スキル定義（1個: rebuild）
└── settings.local.json # 権限設定
```

### 2.3 名前衝突分析

| 標準コマンド | カスタムコマンド | 衝突 |
|-------------|----------------|------|
| `/review` | なし | なし |
| その他39種 | 12種 | **衝突なし** |

**結論**: 現在のカスタムコマンドは標準コマンドと名前が重複していない。

---

## 3. 設計分析

### 3.1 Claude Codeの仕組み

Claude Codeは以下の優先順位でスラッシュコマンドを解決する：

1. **組み込みコマンド**（`/clear`, `/compact`等）
2. **カスタムコマンド**（`.claude/commands/*.md`）
3. **MCPサーバー提供コマンド**

**重要な発見**:
- 組み込みコマンドは**常に利用可能**
- カスタムコマンドで上書きは**不可能**（組み込みが優先）
- `/help`で全コマンド一覧を確認可能

### 3.2 問題の本質

Issue #56の要求を再分析すると：

> **実は既に標準コマンドは利用可能**

Claude Code CLIでは、組み込みコマンドは**デフォルトで利用可能**であり、特別な設定は不要。

ユーザーが認識していない可能性がある点：
1. `/help`で全コマンドを確認できる
2. カスタムコマンドは標準コマンドを上書きしない
3. 新しい標準コマンドは自動的に利用可能になる

---

## 4. 設計方針

### 4.1 推奨アプローチ: **対応不要**

| 項目 | 結論 |
|------|------|
| 実装変更 | **不要** |
| 設定変更 | **不要** |
| ドキュメント更新 | **推奨** |

### 4.2 理由

1. **標準コマンドは既に利用可能**
   - Claude Codeの組み込み機能として自動提供
   - プロジェクト固有の設定は不要

2. **自動対応の要件を満たす**
   - Claude Codeのアップデートで新コマンドが追加されると自動で利用可能
   - プロジェクト側の変更は一切不要

3. **カスタムコマンドとの共存**
   - 名前空間の衝突なし
   - 両方を併用可能

### 4.3 検証方法

```bash
# 標準コマンドが利用可能か確認
/help

# 具体的なコマンドテスト
/clear
/compact
/status
/context
```

---

## 5. ドキュメント改善提案

### 5.1 CLAUDE.md への追記案

```markdown
## スラッシュコマンド

### 標準コマンド（組み込み）
Claude Code標準の39種類のスラッシュコマンドが利用可能です：
- `/help` - 全コマンド一覧
- `/clear` - 会話履歴クリア
- `/compact` - コンテキスト圧縮
- `/status` - ステータス確認
- その他: `/config`, `/context`, `/cost`, `/doctor`など

詳細は `/help` で確認してください。

### カスタムコマンド（プロジェクト固有）
`.claude/commands/` に定義された12種類のコマンド：
- `/work-plan` - 作業計画立案
- `/pm-auto-dev` - 自動開発フロー
- （以下省略）
```

### 5.2 ユーザーガイド更新案

`docs/user-guide/commands-guide.md` に標準コマンドセクションを追加

---

## 6. 代替案の検討

### 案A: ドキュメント更新のみ（推奨）
- **作業量**: 小
- **効果**: ユーザーの認識向上
- **リスク**: なし

### 案B: コマンドラッパー作成
- **内容**: カスタムコマンドで標準コマンドをラップ
- **却下理由**: 冗長、保守コスト増、意味なし

### 案C: 何もしない
- **内容**: 現状維持
- **問題**: ユーザーの混乱が継続

---

## 7. 決定事項とトレードオフ

| 決定事項 | 理由 | トレードオフ |
|---------|------|-------------|
| 実装変更なし | 既に要件を満たしている | なし |
| ドキュメント更新 | ユーザー認識向上 | 軽微な作業 |
| Issueクローズ | 対応完了 | なし |

---

## 8. 実装計画

### Phase 1: ドキュメント更新（任意）
1. CLAUDE.md に標準コマンドセクション追加
2. ユーザーガイド更新

### Phase 2: Issue対応
1. 調査結果をIssueにコメント
2. Issueをクローズ（対応不要として）

---

## 9. 検証チェックリスト

- [ ] `/help` で標準コマンド一覧を確認
- [ ] `/clear` が動作することを確認
- [ ] `/compact` が動作することを確認
- [ ] カスタムコマンドが引き続き動作することを確認

---

## 10. 参考資料

- [Claude Code Commands Reference](https://www.gradually.ai/en/claude-code-commands/)
- [Shipyard Claude Code Cheatsheet](https://shipyard.build/blog/claude-code-cheat-sheet/)
- [Slash Commands in the SDK](https://platform.claude.com/docs/en/agent-sdk/slash-commands)

---

## 結論

**Issue #56の要件は既に満たされています。**

Claude Code標準スラッシュコマンドは組み込み機能として**デフォルトで利用可能**であり、新機能追加時も**自動で対応**されます。

推奨アクション:
1. Issueに調査結果をコメント
2. ドキュメントに標準コマンド情報を追加（任意）
3. Issueをクローズ
