{"body":"## 概要\n\nGitHubにて新規リポジトリを作成し、CommandMateから直接cloneを実施した場合、Filesタブからファイルやディレクトリを追加することができない。\n\n## 再現手順\n\n1. GitHubで新規リポジトリを作成（READMEなし、完全に空の状態）\n2. CommandMateの「Clone Repository」機能でリポジトリをclone\n3. 該当ワークツリーを選択し、Filesタブを開く\n4. 「No files found」と表示される\n5. **右クリックしてもコンテキストメニューが表示されない**\n\n## 期待される動作\n\n空のディレクトリであっても、ファイルやディレクトリを作成する手段が提供される：\n- 「+ New File」「+ New Directory」ボタンが表示される\n- または、ルートディレクトリ領域で右クリックするとコンテキストメニューが表示される\n\n## 実際の動作\n\n- 「No files found」メッセージのみが表示される\n- 右クリック操作の対象となる要素が存在しない\n- ファイル/ディレクトリ作成メニューにアクセスできない\n\n## 原因分析\n\n`FileTreeView.tsx`（行665-673）で、空のディレクトリの場合に早期リターンしており、TreeNodeコンポーネントが生成されない。\n\n```tsx\n// Empty state\nif (rootItems.length === 0) {\n  return (\n    <div\n      data-testid=\"file-tree-empty\"\n      className={`p-4 text-center text-gray-500 ${className}`}\n    >\n      <p className=\"text-sm\">No files found</p>\n    </div>\n  );\n}\n```\n\nこの実装により：\n1. TreeNodeが生成されないため、`onContextMenu`ハンドラーが存在しない\n2. ContextMenuコンポーネントの`targetPath`がnullのままになる\n3. ユーザーが右クリック操作でファイル作成メニューにアクセスできない\n\n## 解決策\n\n「No files found」の空状態に「+ New File」「+ New Directory」ボタンを追加する。\n\n```tsx\n// Empty state with action buttons\nif (rootItems.length === 0) {\n  return (\n    <div\n      data-testid=\"file-tree-empty\"\n      className={`p-4 text-center text-gray-500 ${className}`}\n    >\n      <p className=\"text-sm\">No files found</p>\n      <div className=\"mt-2 flex justify-center gap-2\">\n        <button onClick={() => handleCreateFile('')}>+ New File</button>\n        <button onClick={() => handleCreateDirectory('')}>+ New Directory</button>\n      </div>\n    </div>\n  );\n}\n```\n\n## 受入条件\n\n- [ ] 空のディレクトリ（ファイルが存在しない）の場合も、ファイル/ディレクトリを作成できる\n- [ ] 「+ New File」ボタンをクリックすると、ファイル名入力ダイアログが表示される\n- [ ] 「+ New Directory」ボタンをクリックすると、ディレクトリ名入力ダイアログが表示される\n- [ ] 作成成功後、ファイルツリーが更新される\n- [ ] 既存のファイルがある場合は、従来どおり右クリックメニューも使用可能\n\n## 関連ファイル\n\n- `src/components/worktree/FileTreeView.tsx` - 空状態UIの修正\n- `src/components/worktree/ContextMenu.tsx` - コンテキストメニュー（変更不要）\n- `src/lib/file-operations.ts` - ファイル操作ロジック（変更不要）\n\n## 影響範囲\n\n- FileTreeViewコンポーネントのみ\n- 既存のファイル作成・削除・編集機能には影響なし","title":"ファイルが存在しない状態でディレクトリやファイルの新規登録が出来ない"}
