# Trust & Safety

MyCodeBranchDesk のセキュリティモデルと安全な利用方法について説明します。

## セキュリティモデル

### ローカル実行が前提

MyCodeBranchDesk はローカルマシン上で動作します。

- アプリケーション本体、SQLite データベース、tmux セッションはすべてローカルで完結
- 外部への通信は Claude CLI 自体の API 呼び出しのみ
- ユーザーデータを外部サーバーに送信することはありません

### Claude Code への依存

本ツールは Claude Code（または他の CLI ツール）を**操作する UI** です。

- Claude Code 自体の権限設定がそのまま適用されます
- 本ツールが Claude Code の権限を拡張・変更することはありません
- Claude Code が実行できる操作の範囲は、Claude Code 側の設定に従います

### 外部アクセス時の依存（任意）

外出先からアクセスしたい場合に Cloudflare Tunnel を利用できます。

- Cloudflare Tunnel は**任意**であり、ローカル利用のみであれば不要です
- LAN 内アクセスの場合は `MCBD_BIND=0.0.0.0` と `MCBD_AUTH_TOKEN` の設定が必要です

## 最小権限ガイド

### 推奨設定

- `MCBD_ROOT_DIR` には git 管理された**特定のディレクトリのみ**を指定する
- Claude Code の権限設定で、操作対象を対象リポジトリ内に限定する
- `MCBD_AUTH_TOKEN` を設定し、認証なしでのアクセスを防ぐ（LAN/外部アクセス時）

### 非推奨設定

- `MCBD_ROOT_DIR` にホームディレクトリ全体（`~`）を指定すること
- 認証トークンなしで `MCBD_BIND=0.0.0.0` を設定すること
- Claude Code に広範なファイル操作権限を与えた状態で Auto Yes モードを有効にすること

## 危険操作の防止

### 確認ダイアログ

- **Auto Yes モード**の有効化時に確認ダイアログを表示します
- Auto Yes モードは Claude Code の確認プロンプトを自動承認する機能であり、意図しない操作が実行されるリスクがあります

### 操作ログ

- すべてのチャットメッセージは SQLite データベースに記録されます
- Claude Code の詳細出力は `.claude_logs/` にMarkdown形式で保存されます
- 操作履歴をいつでも確認できます

## 注意事項

- 本ツールは Claude Code を経由してファイル操作を行うため、**重要なファイルの削除や変更が発生する可能性**があります
- 重要なリポジトリで利用する場合は、事前にバックアップを取ることを推奨します
- git 管理下のディレクトリであれば、`git stash` や `git checkout` で復元が可能です
- Auto Yes モードは内容を理解した上で使用してください
