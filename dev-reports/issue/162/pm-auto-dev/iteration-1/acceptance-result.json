{
  "status": "passed",
  "issue_number": 162,
  "iteration": 1,
  "test_cases": [
    {
      "scenario": "Scenario 1: File Move - ContextMenu Move selection -> MoveDialog directory selection -> Move success",
      "result": "passed",
      "evidence": "ContextMenu.tsx has 'Move' menu item (id: 'move') with FolderInput icon and onMove callback. MoveDialog.tsx implements directory tree browser with root selection and subdirectory navigation. useFileOperations.ts handles PATCH API call with action:'move'. API route.ts PATCH handler dispatches to moveFileOrDirectory(). 5 successful move tests pass (file move, directory move, root destination, nested move, content preservation)."
    },
    {
      "scenario": "Scenario 2: Protected directory rejection - .git/ file move -> Error",
      "result": "passed",
      "evidence": "moveFileOrDirectory() calls isProtectedDirectory(sourcePath) at step 2. Tests verify: .git/HEAD move rejected (PROTECTED_DIRECTORY), .git directory move rejected (PROTECTED_DIRECTORY), node_modules file move rejected (PROTECTED_DIRECTORY). Destination protected directory checks also implemented at steps 5 and 11."
    },
    {
      "scenario": "Scenario 3: Directory traversal prevention - ../ path -> Error",
      "result": "passed",
      "evidence": "moveFileOrDirectory() uses validateFileOperation() which calls isPathSafe() for source path, and isPathSafe() directly for destination path. Tests verify: '../etc/passwd' source path rejected (INVALID_PATH), '../outside' destination path rejected (INVALID_PATH)."
    },
    {
      "scenario": "Scenario 4: Birthtime display - FileTreeView shows file birthtime",
      "result": "passed",
      "evidence": "TreeItem interface has 'birthtime?: string' field (CO-001). readDirectory() in file-tree.ts sets birthtime: entryStat.birthtime.toISOString() for files. FileTreeView.tsx TreeNode renders formatRelativeTime(item.birthtime, locale) for non-directory items. 6 birthtime tests pass including ISO format validation and backward compatibility."
    },
    {
      "scenario": "Scenario 5: File content copy - FileViewer copy button click -> Clipboard copy -> Icon change",
      "result": "passed",
      "evidence": "FileViewer.tsx has handleCopy() using copyToClipboard(content.content). Copy button uses data-testid='copy-content-button'. Icon toggles from Copy to Check (green-600) on success. setTimeout resets after 2000ms. Button hidden for image files (!content.isImage). No Toast usage."
    },
    {
      "scenario": "Scenario 6: Unit tests - 43 new tests all pass",
      "result": "passed",
      "evidence": "Vitest run output: 4 test files, 43 tests passed, 0 failed. Breakdown: file-operations-validate (8), file-operations-move (22), date-utils (7), file-tree-timestamps (6). Duration: 571ms."
    },
    {
      "scenario": "Scenario 7: Regression - All existing tests pass",
      "result": "passed",
      "evidence": "Full unit test suite: 172/173 test files passed, 3385 tests passed, 7 skipped. 1 infrastructure error is pre-existing Vitest worker crash (not related to Issue #162). No test failures."
    },
    {
      "scenario": "Scenario 8: i18n - en/ja UI labels correctly displayed",
      "result": "passed",
      "evidence": "locales/en/worktree.json: fileTree section with moveTo, moveDialogTitle, moveConfirm, moveSuccess, timeAgo, rootDirectory. locales/ja/worktree.json: corresponding Japanese translations. locales/en/error.json: failedToMove added. locales/ja/error.json: failedToMove Japanese translation added. MoveDialog.tsx uses useTranslations('worktree') for all labels. FileTreeView.tsx passes locale to formatRelativeTime via getDateFnsLocale()."
    }
  ],
  "acceptance_criteria_status": [
    {
      "criterion": "Context menu 'Move' selection with destination directory selection for file/directory move",
      "verified": true,
      "evidence": "ContextMenu.tsx 'move' item -> MoveDialog.tsx tree browser -> useFileOperations.ts PATCH API -> moveFileOrDirectory() with SEC-005 through SEC-009 security layers"
    },
    {
      "criterion": "isPathSafe() path validation during move preventing directory traversal",
      "verified": true,
      "evidence": "moveFileOrDirectory() validates source via validateFileOperation()/isPathSafe(), destination via isPathSafe(), and final destination path via isPathSafe() (SEC-008). Symlink validation via realpathSync() (SEC-006)."
    },
    {
      "criterion": "File creation time (birthtime) displayed in file tree",
      "verified": true,
      "evidence": "TreeItem.birthtime field added. readDirectory() reads entryStat.birthtime.toISOString(). FileTreeView renders formatRelativeTime() with locale support. Displayed as 'hidden sm:inline' (visible on sm+ screens)."
    },
    {
      "criterion": "FileViewer one-click copy of full text file content",
      "verified": true,
      "evidence": "FileViewer.tsx handleCopy() calls copyToClipboard(content.content). Uses existing clipboard-utils.ts. Button shown only for text files (!content.isImage)."
    },
    {
      "criterion": "Copy success feedback via icon change (no Toast)",
      "verified": true,
      "evidence": "FileViewer.tsx: copied state toggles icon from Copy to Check (green-600). 2s setTimeout resets state. No Toast component imported or used."
    },
    {
      "criterion": "Unit tests added for new functions and APIs",
      "verified": true,
      "evidence": "43 new tests across 4 files: file-operations-validate.test.ts (8), file-operations-move.test.ts (22), date-utils.test.ts (7), file-tree-timestamps.test.ts (6). All pass."
    },
    {
      "criterion": "All existing tests pass",
      "verified": true,
      "evidence": "3385 tests passed, 0 failed. 172/173 test files passed. 1 infrastructure error is pre-existing and unrelated."
    },
    {
      "criterion": "i18n support (en/ja) implemented",
      "verified": true,
      "evidence": "en/ja worktree.json: fileTree.moveTo, moveDialogTitle, moveConfirm, moveSuccess, timeAgo, rootDirectory. en/ja error.json: fileOps.failedToMove. All components use useTranslations()."
    }
  ],
  "security_checks": {
    "SEC-005_protected_directory": {
      "status": "passed",
      "evidence": "Source: isProtectedDirectory(sourcePath) check. Destination: isProtectedDirectory(destinationDir) and isProtectedDirectory(newRelativePath) checks. 5 tests verify .git, node_modules source rejection and .git destination rejection."
    },
    "SEC-006_symlink_validation": {
      "status": "passed",
      "evidence": "realpathSync(destFullPath) resolves symlinks, then validates resolved path starts with resolvedRoot + sep. 1 test verifies symlink to outside directory is rejected."
    },
    "SEC-007_move_into_self": {
      "status": "passed",
      "evidence": "resolvedNewFull.startsWith(resolvedSourceReal + sep) check with path separator prevents false positives. 3 tests: self-move, deeply nested child, src/src-backup false positive prevention."
    },
    "SEC-008_final_destination_validation": {
      "status": "passed",
      "evidence": "isPathSafe(newRelativePath, worktreeRoot) validates the computed destination path (destinationDir + basename). 1 test verifies."
    },
    "SEC-009_toctou_defense": {
      "status": "passed",
      "evidence": "Pre-check with existsSync(newFullPath) for UX. rename() error catch for EEXIST/ENOTEMPTY as TOCTOU defense. 1 test verifies existing destination file detection."
    }
  },
  "static_analysis": {
    "typescript": {
      "status": "passed",
      "evidence": "npx tsc --noEmit: 0 errors"
    },
    "eslint": {
      "status": "passed",
      "evidence": "npm run lint: No ESLint warnings or errors"
    }
  },
  "evidence_files": [
    "tests/unit/lib/file-operations-validate.test.ts",
    "tests/unit/lib/file-operations-move.test.ts",
    "tests/unit/lib/date-utils.test.ts",
    "tests/unit/lib/file-tree-timestamps.test.ts"
  ],
  "message": "All 8 acceptance criteria verified and all 8 test scenarios passed. Security requirements SEC-005 through SEC-009 are implemented and tested. i18n support for en/ja is complete. No regressions detected."
}
