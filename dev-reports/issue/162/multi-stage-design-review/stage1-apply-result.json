{
  "issue_number": 162,
  "stage": 1,
  "stage_name": "通常レビュー",
  "status": "success",
  "design_policy_updated": true,
  "reflected_items": {
    "must_fix": [
      {
        "id": "MF-001",
        "item": "moveFileOrDirectory() と renameFileOrDirectory() のコード重複",
        "principle": "DRY",
        "section_updated": "3-1-0, 3-1-1, 6-1, 8, 9, 13",
        "status": "reflected",
        "description": "validateFileOperation() 共通バリデーションヘルパー関数の設計を追加。責務分担表、利用箇所、テスト計画を含む。"
      },
      {
        "id": "MF-002",
        "item": "WorktreeDetailRefactored への handleMove 追加による肥大化",
        "principle": "SRP/KISS",
        "section_updated": "2-1, 3-1-5, 3-1-6, 8, 9, 13",
        "status": "reflected",
        "description": "useFileOperations() カスタムフックの設計を追加。段階的移行方針（Phase 1: handleMove のみ、Phase 2: 既存ハンドラー移行）を策定。"
      }
    ],
    "should_fix": [
      {
        "id": "SF-001",
        "item": "formatRelativeTime() が FileTreeView 内に定義される設計",
        "principle": "DRY",
        "section_updated": "2-1, 3-2-3, 3-2-4, 6-1, 8, 9, 13",
        "status": "reflected",
        "description": "formatRelativeTime() の配置先を FileTreeView.tsx から src/lib/date-utils.ts に変更。新規セクション 3-2-4 を追加し、テストファイルも追加。"
      },
      {
        "id": "SF-002",
        "item": "MoveDialog のディレクトリツリー取得が tree API を再利用する設計の複雑さ",
        "principle": "KISS",
        "section_updated": "3-1-3, 7",
        "status": "reflected",
        "description": "クライアント側フィルタリングで初回実装し、将来的な ?type=directory サーバー側フィルタリングの方針を注記。"
      },
      {
        "id": "SF-003",
        "item": "PATCH ハンドラーの action 分岐が if/else チェーンになる可能性",
        "principle": "OCP",
        "section_updated": "3-1-2, 8, 13",
        "status": "reflected",
        "description": "現時点は switch 文で実装し、3つ目のアクション追加時にハンドラーマップパターンへリファクタリングする方針を明記。将来のコード例も記載。"
      },
      {
        "id": "SF-004",
        "item": "i18n キーの名前空間配置",
        "principle": "DRY",
        "section_updated": "5-1, 8, 9, 13",
        "status": "reflected",
        "description": "i18n キーの配置先を common.json から worktree.json に変更。名前空間指定方法も記載。"
      }
    ],
    "consider": [
      {
        "id": "CO-001",
        "item": "mtime フィールドの必要性",
        "principle": "YAGNI",
        "section_updated": "2-1, 3-2-1, 3-2-2, 8, 13",
        "status": "reflected",
        "description": "初回は birthtime のみ追加する方針を明記。mtime は YAGNI 原則に基づき必要時に追加。開発者判断での追加も許容する注記を含む。"
      },
      {
        "id": "CO-002",
        "item": "ツールチップによる正確な日時表示の将来対応",
        "principle": "KISS",
        "section_updated": "3-2-3, 8, 13",
        "status": "reflected",
        "description": "title 属性でブラウザネイティブツールチップを設定する設計を追加。コード例も記載。"
      },
      {
        "id": "CO-003",
        "item": "MoveDialogProps の sourceType パラメータ",
        "principle": "ISP",
        "section_updated": "3-1-3, 13",
        "status": "reflected",
        "description": "sourceType Props をバリデーション目的で維持する理由を注記。"
      }
    ]
  },
  "skipped": [],
  "design_doc_path": "dev-reports/design/issue-162-file-enhancement-design-policy.md",
  "sections_updated": [
    "2. アーキテクチャ設計（レイヤー構成・データフロー更新）",
    "3-1-0. 共通バリデーションヘルパー（新規追加）",
    "3-1-1. バックエンド moveFileOrDirectory（DRY-001 更新）",
    "3-1-2. APIルート PATCH（OCP方針追加）",
    "3-1-3. MoveDialog（SF-002/CO-003 注記追加）",
    "3-1-5. WorktreeDetailRefactored（MF-002 設計根拠追加）",
    "3-1-6. useFileOperations()（新規追加）",
    "3-2-1. データモデル（CO-001 mtime方針追加）",
    "3-2-2. file-tree.ts（birthtime のみに変更）",
    "3-2-3. FileTreeView（SF-001/CO-002 更新）",
    "3-2-4. formatRelativeTime()（新規追加）",
    "4. セキュリティ設計（validateFileOperation 反映）",
    "5. i18n対応（SF-004 配置先変更）",
    "6. テスト戦略（新規テスト追加）",
    "7. パフォーマンス考慮（SF-002 注記追加）",
    "8. 設計上の決定事項とトレードオフ（全指摘反映）",
    "9. 実装対象ファイル一覧（新規ファイル追加）",
    "11. レビュー履歴（新規追加）",
    "12. レビュー指摘事項サマリー（新規追加）",
    "13. 実装チェックリスト（新規追加）"
  ],
  "timestamp": "2026-02-15T00:00:00Z"
}
