{"body":"## 概要\n\nファイルツリーに検索機能を追加し、PC・スマホ両方で快適にファイルを探せるようにする。\n\n## 背景・課題\n\n- ワークツリー内のファイル数が多い場合、目的のファイルを探すのに時間がかかる\n- 特にスマホでは画面が狭く、ツリーをスクロールして探すのが困難\n- ファイル名だけでなく、ファイル内容で検索したいケースもある\n\n## 提案する解決策\n\n### 検索UI\n\n- **検索バー常時表示**: ファイルツリー上部に検索入力欄を常時表示\n- **検索モード切替**: ファイル名検索 / ファイル内容検索をトグルで切り替え\n- **レスポンシブ対応**: PC・スマホ両方で使いやすいUI\n\n### 検索対象\n\n| モード | 検索対象 | 説明 |\n|--------|---------|------|\n| ファイル名検索 | ファイル名・ディレクトリ名 | パス内の文字列でマッチ |\n| ファイル内容検索 | ファイル内テキスト | grep的な全文検索 |\n\n### 検索結果表示\n\n- **ツリーフィルタ方式**: マッチしないファイルを非表示にしてツリーを絞り込む\n- マッチしたファイルの親ディレクトリは自動展開\n- 検索クリア時は元のツリー表示に戻る\n\n### UI設計案\n\n```\n┌─────────────────────────────┐\n│ 🔍 [検索入力欄        ] [名前|内容] │  ← 検索バー + モード切替\n├─────────────────────────────┤\n│ 📁 src/                     │\n│   📁 components/            │\n│     📄 Button.tsx  ←マッチ   │\n│   📁 lib/                   │\n│     📄 utils.ts    ←マッチ   │\n└─────────────────────────────┘\n```\n\n## 技術要件\n\n### フロントエンド\n\n- 検索入力はdebounce処理（300ms程度）でAPI呼び出しを抑制\n- インクリメンタルサーチ対応\n- 検索中はローディング表示\n\n### バックエンド（ファイル内容検索）\n\n- API: `GET /api/worktrees/:id/search?q=<query>&mode=name|content`\n- ファイル内容検索時はテキストファイルのみ対象\n- 検索結果は最大100件程度に制限（パフォーマンス考慮）\n\n### セキュリティ\n\n- パストラバーサル対策（既存のisPathSafe()を使用）\n- 大きなファイルの検索時のタイムアウト設定\n\n## 受け入れ条件\n\n### 必須条件\n\n- [ ] ファイルツリー上部に検索バーが常時表示されること\n- [ ] ファイル名検索モードで、入力文字列にマッチするファイル/ディレクトリのみ表示されること\n- [ ] ファイル内容検索モードで、ファイル内テキストにマッチするファイルのみ表示されること\n- [ ] 検索モード（名前/内容）を切り替えられること\n- [ ] 検索クリア時に元のツリー表示に戻ること\n- [ ] PCで動作すること\n- [ ] スマホで動作すること\n\n### 追加条件\n\n- [ ] 検索中にローディング表示されること\n- [ ] 検索結果が0件の場合、適切なメッセージが表示されること\n- [ ] マッチしたファイルの親ディレクトリが自動展開されること\n\n## 対象外（将来検討）\n\n- 正規表現検索\n- 大文字/小文字の区別オプション\n- 検索履歴の保存\n- 複数ワークツリーを跨いだ検索","title":"PCでの利用時とスマホでの利用時ともにファイルツリーにてファイル検索したい"}
