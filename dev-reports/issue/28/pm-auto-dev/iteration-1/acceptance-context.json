{
  "issue_number": 28,
  "feature_summary": "履歴表示改善 - Assistantからの履歴表示が一部切れる問題の修正",
  "tdd_result": {
    "status": "success",
    "coverage": 80.0,
    "tests_passed": 1083,
    "tests_failed": 0
  },
  "acceptance_criteria": [
    {
      "id": "AC-1",
      "description": "長いテキストが切れずに表示されること",
      "test_method": "CSS検証 - word-break:break-word, max-w-full, overflow-x-hidden が適用されている"
    },
    {
      "id": "AC-2",
      "description": "Safari でも正常に表示されること",
      "test_method": "overflow-wrap:anywhere ではなく word-break:break-word が使用されている"
    },
    {
      "id": "AC-3",
      "description": "スクロール位置が正しく復元されること",
      "test_method": "useScrollRestoration フックが正常に動作する（15テストケース）"
    },
    {
      "id": "AC-4",
      "description": "ページネーション用フックが準備されていること",
      "test_method": "useScrollObserver, useInfiniteMessages フックが作成され、テストが通っている"
    },
    {
      "id": "AC-5",
      "description": "単体テストカバレッジ80%以上",
      "test_method": "npm run test:unit でカバレッジ確認"
    },
    {
      "id": "AC-6",
      "description": "静的解析エラーがないこと",
      "test_method": "npm run lint && npx tsc --noEmit"
    }
  ],
  "test_scenarios": [
    {
      "id": "TS-1",
      "name": "CSS修正の検証",
      "steps": [
        "ConversationPairCard.tsx を確認",
        "AssistantMessageItem のCSSに word-break:break-word, max-w-full, overflow-x-hidden が含まれていることを確認"
      ],
      "expected": "指定されたCSSクラスが適用されている"
    },
    {
      "id": "TS-2",
      "name": "スクロール管理フックの検証",
      "steps": [
        "useScrollRestoration.ts が存在することを確認",
        "単体テストが全て通ることを確認"
      ],
      "expected": "フックが正常に動作し、全テスト合格"
    },
    {
      "id": "TS-3",
      "name": "ページネーションフックの検証",
      "steps": [
        "useScrollObserver.ts と useInfiniteMessages.ts が存在することを確認",
        "単体テストが全て通ることを確認"
      ],
      "expected": "フックが正常に動作し、全テスト合格"
    },
    {
      "id": "TS-4",
      "name": "ビルド検証",
      "steps": [
        "npm run build を実行"
      ],
      "expected": "ビルドが成功する"
    }
  ],
  "files_to_verify": [
    "src/components/worktree/ConversationPairCard.tsx",
    "src/components/worktree/HistoryPane.tsx",
    "src/hooks/useScrollRestoration.ts",
    "src/hooks/useScrollObserver.ts",
    "src/hooks/useInfiniteMessages.ts",
    "src/types/infinite-messages.ts"
  ]
}
